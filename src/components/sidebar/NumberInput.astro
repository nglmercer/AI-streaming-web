---
// src/components/NumberInput.astro
import FormField from './FormField.astro';

interface Props {
  label: string;
  value: number;
  id: string;
}
const { label, value,id } = Astro.props;
---
<FormField {label} class="flex-row items-center justify-between py-2">
  <div class="relative flex items-center">
    <input
      type="number"
      id={id}
      value={value}
      class="bg-gray-700 border border-gray-600 scheme-light-dark rounded-md py-1.5 pl-3 pr-8 text-white w-28 text-right"
    />
  </div>
</FormField>
<script>
    import { DataStorage,LocalStorageAdapter } from "json-obj-manager";
    const ConfigData = new DataStorage<string>(new LocalStorageAdapter('config'))
  // src/components/sidebar/NumberInput.astro
  document.addEventListener('DOMContentLoaded',async () => {
    const numberInputs = document.querySelectorAll('input[type="number"][id]');
    const alldata = await ConfigData.getAll()
    console.log("ConfigData",alldata)
    numberInputs.forEach(input => {
      const inputElement = input as HTMLInputElement;
      const id = inputElement.getAttribute('id');

      if (id) {
        const storedValue = alldata[id]
        if (storedValue) {
          inputElement.value = storedValue;
        }

        inputElement.addEventListener('input', (event) => {
          const target = event.target as HTMLInputElement;
          console.log("input",target.value)
          if (!target) return;
          ConfigData.save(id,target.value)
        });
      }
    });
  });
</script>
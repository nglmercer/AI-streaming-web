---
// src/components/Subtitles.astro
// Componente de subtítulos múltiples con API de librería
---

<!-- Contenedor principal donde se crearán dinámicamente los subtítulos -->
<div id="subtitles-root" class="fixed inset-0 pointer-events-none z-50">
    <!-- Los subtítulos se crearán dinámicamente aquí -->
</div>

<script>
    import { emitter } from '@utils/Emitter';
    import { Subtitles } from './Subtitles/subcore';
    import type{ QueuedSubtitle, SubtitleConfig,SubtitlePosition,SubtitleStyle } from './Subtitles/types';
    // API compatible con eventos (mantener compatibilidad)
    Subtitles.init('subtitles-root');
    emitter.on('subtitles:show', (config: SubtitleConfig) => {
        console.log("subtittle",config)
        Subtitles.show(config);
    });

    emitter.on('subtitles:hide', (id?: string) => {
        if (id) {
            Subtitles.hide(id);
        } else {
            Subtitles.hideAll();
        }
    });

    emitter.on('subtitles:queue', (data: { queueId?: string; subtitles: QueuedSubtitle[] }) => {
        const queueId = data.queueId || 'default';
        Subtitles.queue(queueId, data.subtitles);
    });

    emitter.on('subtitles:clear', () => {
        Subtitles.clear();
    });

    emitter.on('subtitles:stop-queue', (queueId: string) => {
        Subtitles.stopQueue(queueId);
    });
</script>